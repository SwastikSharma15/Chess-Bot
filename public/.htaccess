# Compression
<IfModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file \.(html?|txt|css|js|json|xml|svg|webp)$
  mod_gzip_item_include handler ^cgi-script$
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_include mime ^application/json$
  mod_gzip_item_exclude mime ^image/.*
  mod_gzip_level 6
</IfModule>

# Enable mod_deflate for compression (alternative to mod_gzip)
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
</IfModule>

# Browser Caching
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault                                      "access plus 1 month"
  ExpiresByType text/cache-manifest                  "access plus 0 seconds"
  ExpiresByType text/html                            "access plus 0 seconds"
  ExpiresByType text/xml                             "access plus 0 seconds"
  ExpiresByType application/xml                      "access plus 0 seconds"
  ExpiresByType application/json                     "access plus 0 seconds"
  ExpiresByType application/atom+xml                 "access plus 1 hour"
  ExpiresByType application/rss+xml                  "access plus 1 hour"
  ExpiresByType image/gif                            "access plus 1 month"
  ExpiresByType image/jpeg                           "access plus 1 month"
  ExpiresByType image/jpg                            "access plus 1 month"
  ExpiresByType image/png                            "access plus 1 month"
  ExpiresByType image/svg+xml                        "access plus 1 month"
  ExpiresByType image/webp                           "access plus 1 month"
  ExpiresByType video/mp4                            "access plus 1 month"
  ExpiresByType text/css                             "access plus 1 year"
  ExpiresByType text/javascript                      "access plus 1 year"
  ExpiresByType application/javascript               "access plus 1 year"
  ExpiresByType application/x-javascript             "access plus 1 year"
  ExpiresByType font/truetype                        "access plus 1 year"
  ExpiresByType font/opentype                        "access plus 1 year"
  ExpiresByType font/woff                            "access plus 1 year"
  ExpiresByType font/woff2                           "access plus 1 year"
  ExpiresByType application/x-font-ttf               "access plus 1 year"
  ExpiresByType application/x-font-opentype         "access plus 1 year"
  ExpiresByType application/x-font-woff              "access plus 1 year"
  ExpiresByType application/font-woff                "access plus 1 year"
</IfModule>

# ETag Header
<IfModule mod_headers.c>
  Header unset ETag
</IfModule>
FileETag None

# Remove ETags
Header unset ETag
FileETag None

# Set proper cache control headers
<IfModule mod_headers.c>
  # Cache HTML for immediate revalidation (no caching)
  <FilesMatch "\.(html|htm)$">
    Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
  </FilesMatch>
  
  # Cache static assets for 1 year
  <FilesMatch "\.(js|css|woff|woff2|ttf|svg|eot|otf|webp|png|jpg|jpeg|gif|ico)$">
    Header set Cache-Control "max-age=31536000, public"
  </FilesMatch>
  
  # Cache JSON-LD and manifest
  <FilesMatch "\.(json|xml)$">
    Header set Cache-Control "max-age=2592000, public"
  </FilesMatch>
</IfModule>

# GZIP compression for SVG
AddType image/svg+xml svg svgz
AddEncoding gzip svgz

# Proper MIME types
AddType application/javascript js
AddType text/css css
AddType image/webp webp
AddType application/json json
AddType application/xml xml
AddType application/rss+xml rss
AddType application/atom+xml atom
